---
title: "GRAPH Workshop: Universaltool Regression"
subtitle: "Sitzung 3"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    code_folding: show
    self_contained: true
    thumbnails: false
    lightbox: true
    downcute_theme: "chaos"
pkgdown:
  as_is: true
---

## Wiederholung: Deskriptiv- und Inferenzstatistik der multiplen Regression
Aus aktuellem Anlass: Bitte lest Sie diese ["Analyse"](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&ved=2ahUKEwil9-Hk9sX0AhU2gv0HHYAqCk8QFnoECAcQAQ&url=https%3A%2F%2Fwww.utebergner.de%2Fcms%2Fwp-content%2Fuploads%2F2021%2F11%2F%25C3%259Cbersterblichkeit-KW-36-bis-40-in-2021-003.docx&usg=AOvVaw0_93ZB0fmqD6gfd7ISmGfj) und kritisiert die Anwendbarkeit der Regressionsmodellierung anhand eures reichhaltigen Vorwissens aus den letzten beiden Sitzungen üòâ (zur journalistischen Aufarbeitung siehe z.B. [hier](https://www.heise.de/tp/features/Forencheck-Niedrige-Uebersterblichkeit-in-Sachsen-Impfquote-in-Afrika-und-der-Begriff-der-Immunitaet-6279279.html)

## √úbung: Deskriptiv- und Inferenzstatistik der multiplen Regression 
In Kapitel 3 (siehe moodle) aus Gelman & Hill (2006) wird in Abbildung 3.2. der Testrohwert eines Intelligenztest von Kindern `kid_score` mit dem IQ-Wert der M√ºtter `mom_iq` pr√§diziert. Ihr k√∂nnt die zugeh√∂rigen Daten mit der folgenden Syntax importieren
```{r, message=FALSE, results='hide'}
library(tidyverse)
data_kidiq <- read_delim("https://raw.githubusercontent.com/sammerk/did_data/master/kidiq.csv")
```

```{r, echo = F, results='hide'}
haven::write_sav(data_kidiq, "data/kidiq.sav")
```

JASP, jamovi und SPSS-Nutzer\*innen k√∂nnen den Datensatz `r xfun::embed_file("data/kidiq.sav", "kidiq.sav", "hier")` herunterladen.

> AA: Bitte pr√§diziert `kid_score` mit `mom_iq`, berechnet Effektst√§rken und Inferenzstatistiken und pr√ºft, inwiefern Ihr die Annahmen dieser f√ºr hinreichend erf√ºllt anseht.

### Regression `kid_score ~ mom_iq`
Die Syntax f√ºr ein nicht-standardisiertes Modell:
```{r}
lm(kid_score ~ mom_iq, data = data_kidiq)
```

Da die Daten keine missings enthalten, kann man direkt in dere "formula" `scale()` f√ºr die Standardisierung anwenden und erh√§lt via `summary()` auch $R^2$ und p-Werte f√ºr $\beta_i$ und $R^2$.
```{r}
mod_kidiq_1 <- lm(scale(kid_score) ~ scale(mom_iq), data = data_kidiq)
summary(mod_kidiq_1)
```

Mit $\beta_1 = .4$ haben wir einen moderaten bis starken Effekt nach Cohen (1988), der p-Wert ist < .05. Auch der $BF_{10}$ zeigt sehr starke relative Evidenz f√ºr das Modell mit Pr√§diktor:
```{r}
library(BayesFactor)
lmBF(formula = kid_score ~ mom_iq, data = data_kidiq)
```

### Regressionsdiagnostik
```{r, fig.retina = 3}
library(hrbrthemes)
ggplot(data_kidiq, aes(mom_iq, kid_score)) + 
  geom_point() + 
  stat_smooth() + 
  theme_modern_rc()
```

### Annahmen
```{r, fig.height=10}
library(performance)
check_model(mod_kidiq_1)
```

## Dummykodierung
Gelman und Hill (2008) ...